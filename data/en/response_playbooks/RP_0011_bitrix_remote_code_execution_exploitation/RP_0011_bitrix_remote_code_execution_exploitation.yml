title: Bitrix remote code execution exploitation
description: Response playbook for "Bitrix remote code execution exploitation" attack
id: RP0011
author: '@ERMACK_COMMUNITY'
creation_date: 2023/07/10
modification_date: 2023/07/11
linked_artifacts:
  - A3002
  - A4001
  - A1008
  - A1007
  - A2001
  - A2002
tags:
  - status.stable
  - severity.high
  - tlp.amber
  - pap.white
  - bitrix
preparation:
  - RP_1001_operational_preparations
identification:
  - RA_2008_prepare_iocs_list
  - RA_2321_scan_on_suspicious_files #TODO
  - RA_2010_ensure_successful_attack #TODO
  - RA_2009_scan_with_iocs_and_rules
  - RA_2302_list_files_modified
  - RP_1005_persist_on_linux_host #TODO
  - RA_2406_find_process_by_executable_content_pattern
containment:
  - RA_3001_patch_vulnerability
  - RA_3002_restrict_access_to_vulnerable_components #TODO
eradication:
  - RA_4301_remove_file
  - RA_4401_kill_process #TODO
  - RA_4003_clear_backup_copy #TODO
recovery:
  - RA_5002_restore_data_from_backup
  - RA_5003_check_service_for_correct_work #TODO
  - RA_5603_change_users_passwords #TODO
lessons_learned:
  - RA_6001_develop_incident_report
  - RA_6002_conduct_lessons_learned_exercise

extended_description: |
  Attackers can exploiting vulnerabilities in bitrix CMS for remote code execution on server. After that, they can carry out attacks within the network. When responding to this incident, it is important to check for known IOCs, as well as pay attention to suspicious files that are not in the standard distribution.
workflow: |
  
  #TODO: add workflow
  
  ## Response discovery mapping
  | ARTIFACT                  | RESPONSE ACTION                                                                                | RESPONSE ACTION OBSERVABLES                                                    |
  | ------------------------- | ---------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------ |
  | <[File]>(A_3002) | [Scan on suspicious files](#identification) <br> *Find suspicious files and known IOCs files using bitrix.xscan and standard utilities (ex. grep)* | Web shell loaded by attackers or modified file |
  | <[Process]>(A_4001) | [Find process by executable content pattern](#identification) <br> [Kill Process](#eradication) <br> *After stop <[web application server]>(A_2001) find remaining 'php' processes and kill them* | Process in which attackers code execute |
  | <[Log]>(A_1008) | [Ensure successful attack](#identification) <br> *Find the success of the exploit in the <[web server]>(A_2002) logs* | Log with successful exploit that contains <[ip address]>(A_1007) from which the attack was carried out |
