title: Анализировать скрипт
id: RA2318
description: >
  Проанализировать запускаемые скрипты (Powershell, Batch, VBSript, Bash, Python и т.д.)
author: enikulina
creation_date: 2023/02/06
stage: identification
references:
  - https://www.base64decode.org/
  - https://www.virustotal.com
workflow: |
  Извлечь запускаемые скрипты доступным способом и проанализировать их:
  
  - При наличии обфускации и закодированных команд выполнить деобфускацию и декодирование (например, для [b64] https://www.base64decode.org/).
  - Выявить возможные вредоносные действия, инициируемые командами в теле скрипта:
           - загрузка внешнего содержимого
           - манипуляции с файлами и папками (в этом случае необходимо получить сам файл и его хеш, после чего перейти к анализу в рамках соответствующих RA)
           - создание запланированной задачи
           - редактирование реестра
           - создание файлов в автозагрузке
           - т.д.
  - Извлечь из тела скрипта все артефакты для дальнейшего расследования и реагирования:
    - URL/IP-адреса
    - имена учетных записей/пароли
    - имена файлов/папок
    - ключи реестра
    - т.д.
