title: Подозрительное сетевое подключение
id: RP9001
description: >
  Сценарий реагирования при обнаружении подозрительного сетевого подключения
author: bpopovich, gkhandozhko
creation_date: 2023/04/26
severity: M
tlp: AMBER
tags:
    - attack.defense_evasion
    - attack.persistence
    - attack.command_and_control
    - sub-playbook
extended_description: |
    Этот сценарий реагирования представляет собой памятку и руководство к действию, предназначенное для специалистов в области информационной безопасности.
preparation:
    - RA_1001_practice
    - RA_1002_take_trainings
    - RA_1012_check_analysis_toolset
    - RA_1091_preparation_ids_ips_firewalls
    - RA_1092_preparation_lan
    - RA_1093_preparation_traffic
    - RA_1104_access_external_http_logs
    - RA_1110_access_external_packet_capture_data
    - RA_1111_get_ability_to_block_external_ip_address
    - RA_1112_get_ability_to_block_internal_ip_address
    - RA_1117_get_ability_to_block_port_external_communication
    - RA_1602_get_ability_to_lock_user_account
identification:
    - RA_2105_analyse_IP
    - RA_2111_collect_transferred_data
    - RA_2114_list_hosts_communicated_with_external_ip
    - RA_2001_list_victims_of_security_alert
    - RA_2091_map_business_risks
    - RP_0009_malicious_process
containment:
    - RA_3101_block_external_ip_address
    - RA_3102_block_internal_ip_address
    - RA_3502_run_antivirus_scan
    - RA_3601_lock_user_account
eradication:
    - RA_4001_report_incident_to_external_csirts
recovery:
    - RA_5105_unblock_blocked_user
    - RA_5106_reestablish_blocked_host
lessons_learned:
    - RA_6001_develop_incident_report
    - RA_6002_conduct_lessons_learned_exercise
extended_description: |
  | Артефакты                               | Действия по реагированию                                                                                                                                                                            | Возможный обнаруженный объект                                                                                              |
  | :-------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| :--------------------------------------------------------------------------------------------------------------------------|
  | <[УЗ домена]>(A_1001)                   | Проверьте имена пользователей домена, которые были обнаружены на этапе идентификация. Убедитесь, что эти учетные записи не были скомпрометированы.                                                  | Имена пользователей, которые участвовали в процессе аутентификации и иной активности во время атаки.                       |
  | <[Хост]>(A_1005)                        | Проверьте хосты, которые были обнаружены на этапе идентификации. Убедитесь, что эти хосты не были скомпрометированы.                                                                                | Пентест-утилиты, иное программное обеспечение для проведения атаки или подозрительные внешние сетевые подключения          |
  | <[IP адрес]>(A_1007)                    | Соберите все IP адреса, которые были обнаружены на этапе идентификации. Отдельно отметьте те, которые принадлежат организации.                                                                      | Нетипичные соединения для IP адреса, например неиспользуемые типы сетевых протоколов взаимодействия.                       |
workflow: |
    1. На этапе подготовки вы проводите учения, проверяете корректность работы средств защиты информации и иных информационных средств. Подтверждаете доступ к результатам работы этих средств, доступ к журналам и дампам сетевого потока. Это поможет в экономии времени при работе с инцидентом.
    2. На этапе идентификации необходимо найти адреса фигурирующие в компьютерной атаке. Это могут быть как <[процессы]>(A_4001) или <[хосты]>(A_1005) так и <[IP адреса]>(A_1007) Среди этих данных нужно выделить критичные для бизнес-процессов организации. Это поможет расставить правильно приоритеты затраты времени в работе. Если в процессе был найден <[процесс]>(A_4001) то следует перейти на сценарий реагирования <[Запуск вредоносного процесса]>.
    3. На этапе локализации необходимо на основе собранной на этапе идентификации информации ограничить распространение атаки с помощью средств защиты информации и иных информационных средств, заблокировать затронутых атакой пользователей и провести сканирование <[хостов]>(A_1005) антивирусными средствами защиты информации. Ведите журнал, с временными метками, своих действий. Это поможет сэкономить много времени.
    4. На этапе предотвращения необходимо <[сообщить об инциденте]>(RA_4001) внешним центрам реагирования, предоставив все найденные идентификаторы компрометации
    5. На этапе восстановления необходимо <[разблокировать]>(RA_5105) ранее заблокированные учетные записи и <[восстановить сетевое взаимодействие]>(RA_5106) с ранее изолированными внутренними хостами 
    6. На этапе жизненного урока необходимо <[составить отчет]>(RA_6001) о произошедшем инциденте в соответствии с принятыми в организации процедурами и <[проанализировать случившееся]>(RA_6002), понять, какие меры нужно предпринять, чтобы инцидент не повторился в дальнейшем
