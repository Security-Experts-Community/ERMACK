title: Подозрительное сетевое соединение
id: RP9001
description: >
  Сценарий реагирования при обнаружении подозрительного сетевого подключения
author: bpopovich, gkhandozhko, enikulina
creation_date: 2023/05/26
severity: M
tlp: AMBER
tags:
    - attack.defense_evasion
    - attack.persistence
    - attack.command_and_control
    - sub-playbook
extended_description: |
    Нестандартная сетевая активность в инфраструктуре, взаимодействие с подозрительными IP и URL-адресами могут свидетельствовать о компрометации корпоративных ресурсов и наличии инцидента ИБ. Поэтому факты подозрительных сетевых соединений требуют тщательного анализа и, в случае подтвержденного инцидента, принятия необходимых мер по реагированию.
preparation:
    - RA_1001_practice
    - RA_1002_take_trainings
    - RA_1012_check_analysis_toolset
    - RA_1015_implement_ids_ips_firewalls
    - RA_1016_check_lan_communication
    - RA_1104_access_external_http_logs
    - RA_1110_access_external_packet_capture_data
    - RA_1111_get_ability_to_block_external_ip_address
    - RA_1112_get_ability_to_block_internal_ip_address
    - RA_1117_get_ability_to_block_port_external_communication
    - RA_1602_get_ability_to_lock_user_account
identification:
    - RA_2111_collect_transferred_data
    - RA_2105_analyse_IP
    - RA_2114_list_hosts_communicated_with_external_ip
    - RA_2001_list_victims_of_security_alert
    - RA_2091_map_business_risks
    - RP_0009_malicious_process
containment:
    - RA_3101_block_external_ip_address
    - RA_3102_block_internal_ip_address
    - RA_3502_run_antivirus_scan
    - RA_3601_lock_user_account
eradication:
    - RA_4001_report_incident_to_external_csirts
recovery:
    - RA_5105_unblock_blocked_user
    - RA_5101_unblock_blocked_internal_ip
lessons_learned:
    - RA_6001_develop_incident_report
    - RA_6002_conduct_lessons_learned_exercise
extended_description: |
  | Артефакты                               | Действия по реагированию                                                                                                                                                                            | Возможный обнаруженный объект                                                                                              |
  | :-------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| :--------------------------------------------------------------------------------------------------------------------------|
  | <[УЗ домена]>(A_1001)                   | Проверьте УЗ пользователей домена, которые были обнаружены на этапе идентификации.                                                                                                                  | Имена пользователей, которые потенциально были скомпрометированы в результате атаки.                                       |
  | <[Хост]>(A_1005)                        | Проверьте хосты, которые были обнаружены на этапе идентификации.                                                                                                                                    | Вредоносные программы и утилиты, использованные для проведения атаки или подозрительные внешние сетевые подключения        |
  | <[IP адрес]>(A_1007)                    | Соберите все IP-адреса, которые были обнаружены на этапе идентификации. Отдельно отметьте те, которые принадлежат организации.                                                                      | Нетипичные соединения для IP-адреса, например, неиспользуемые сетевые протоколы взаимодействия.                            |
workflow: |
    1. На этапе подготовки необходимо провести учения, проверить корректность работы средств защиты информации и иных информационных средств. 
       Подтвердить доступ к результатам работы этих средств, доступ к журналам и дампам сетевого потока.
    2. На этапе идентификации необходимо собрать артефакты, фигурирующие в компьютерной атаке. Например, это могут быть как <[процессы]>(A_4001), так и <[IP адреса]>(A_1007). Если в ходе расследования будет обнаружен <[процесс]>(A_4001), инициировавший нелегитимное сетевое соединение, то следует перейти к сценарию реагирования <[RP0009: Запуск вредоносного процесса]>(RP_0009). 
       Среди затронутых инцидентом активов (<[хостов]>(A_1005)) необходимо выделить критичные для бизнес-процессов организации. Это поможет правильно расставить приоритеты на последующих стадиях реагирования.
    3. На этапе локализации необходимо на основе собранной на этапе идентификации информации ограничить распространение атаки с помощью средств защиты информации и иных информационных средств, заблокировать нелегитимный IP-адрес на сетевом уровне, изолировать скомпрометированные хосты, заблокировать скомпрометированные УЗ и провести сканирование <[хостов]>(A_1005) антивирусными средствами. Не забывайте фиксировать все предпринятые меры по локализации с указанием времени, исполнителя (ответственного) и т.д.
    4. На этапе устранения необходимо <[сообщить об инциденте]>(RA_4001) внешним центрам реагирования, предоставив все найденные индикаторы компрометации.
    5. На этапе восстановления необходимо <[разблокировать]>(RA_5105) ранее заблокированные учетные записи и <[восстановить сетевое взаимодействие]>(RA_5101) ранее изолированных внутренних хостов.
    6. В рамках пост-инцидентного анализа необходимо <[составить отчет]>(RA_6001) о произошедшем инциденте в соответствии с принятыми в организации процедурами и <[проанализировать инцидент]>(RA_6002), понять, какие меры нужно предпринять, чтобы избежать аналогичных инцидентов в будущем.
